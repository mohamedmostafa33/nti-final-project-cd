# ELK Stack Values
# Wraps Elasticsearch + Kibana + Filebeat with project-specific defaults

# ── Elasticsearch ──
elasticsearch:
  replicas: 1
  minimumMasterNodes: 1

  esJavaOpts: "-Xmx1g -Xms1g"

  resources:
    requests:
      cpu: 250m
      memory: 1Gi
    limits:
      cpu: "1"
      memory: 2Gi

  volumeClaimTemplate:
    resources:
      requests:
        storage: 5Gi

  persistence:
    enabled: true

  # Single-node discovery
  extraEnvs:
    - name: discovery.type
      value: single-node

# ── Kibana ──
kibana:
  elasticsearchHosts: "https://elasticsearch-master:9200"

  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 500m
      memory: 1Gi

  service:
    type: ClusterIP

# ── Filebeat ──
filebeat:
  daemonset:
    filebeatConfig:
      filebeat.yml: |
        filebeat.inputs:
        - type: container
          paths:
            - /var/log/containers/*.log
          processors:
            - add_kubernetes_metadata:
                host: ${NODE_NAME}
                matchers:
                  - logs_path:
                      logs_path: "/var/log/containers/"
        output.elasticsearch:
          hosts: ['https://elasticsearch-master:9200']
          username: elastic
          password: '${ELASTICSEARCH_PASSWORD}'
          ssl.verification_mode: none

    extraEnvs:
      - name: ELASTICSEARCH_PASSWORD
        valueFrom:
          secretKeyRef:
            name: elasticsearch-master-credentials
            key: password

  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 250m
      memory: 256Mi
